<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ASCEND</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- CSS -->
    <!-- CSS -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/pages.css">
    <link rel="stylesheet" href="css/header-style.css">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="js/include-components.js"></script>
</head>

<body>
    <!-- Integrated Navigation Placeholder (Loads Sidebar and Header) -->
    <div id="navigation-placeholder" data-src="dashboard-navigation.html"></div>

    <!-- Main Content -->
    <main class="main-layout">
        <div class="page-container">
            <div class="main-content">
                <div class="page-header">
                    <h1 class="page-title">Career Exploration</h1>
                </div>

                <!-- Search Bar -->
                <div class="page-search">
                    <div class="input-icon">
                        <i data-lucide="search" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
                        <input type="text" class="input"
                            placeholder="Search companies, roles, experiences, or roadmaps...">
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <!--
                    <div class="tab active" data-tab="companies">
                        <i data-lucide="building-2" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
                        Companies
                    </div>
                    <div class="tab" data-tab="paths">
                        <i data-lucide="route" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
                        Career Paths
                    </div>
                    <div class="tab" data-tab="experiences">
                        <i data-lucide="briefcase" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
                        Experiences
                    </div>
                    -->
                    <div class="tab active" data-tab="roadmaps">
                        <i data-lucide="map" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
                        Roadmaps
                    </div>
                </div>

                <!--
                
                <div class="tab-content active" id="companies">
                    <div class="company-grid" id="companiesContainer">
                        <p style="padding: 20px; text-align: center; color: var(--text-secondary);">Loading companies...
                        </p>
                    </div>
                </div>

          
                <div class="tab-content" id="paths">
                    <div class="company-grid" id="pathsContainer">
                        <p style="padding: 20px; text-align: center; color: var(--text-secondary);">Loading career
                            paths...</p>
                    </div>
                </div>

                <div class="tab-content" id="experiences">
                    <div style="max-width: 800px;" id="experiencesContainer">
                        <p style="padding: 20px; text-align: center; color: var(--text-secondary);">Loading
                            experiences...</p>
                    </div>
                </div>
                -->

                <!-- Tab Content: Roadmaps -->
                <div class="tab-content active" id="roadmaps">
                    <div class="company-grid" id="roadmapsContainer">
                        <p style="padding: 20px; text-align: center; color: var(--text-secondary);">Loading roadmaps...
                        </p>
                    </div>
                </div>
            </div> <!-- End main-content -->
        </div> <!-- End page-container -->

        <!-- Footer -->
        <div id="footer-placeholder" data-src="dashboard-footer.html"></div>
    </main>

    <script src="js/navigation.js"></script>
    <script src="js/auth-guard.js"></script>
    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function () {
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                // Add active class to clicked tab
                this.classList.add('active');

                // Show corresponding content
                const tabId = this.dataset.tab;
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Check URL for tab parameter
        const urlParams = new URLSearchParams(window.location.search);
        const tab = urlParams.get('tab');
        if (tab) {
            const tabElement = document.querySelector(`[data-tab="${tab}"]`);
            if (tabElement) {
                tabElement.click();
            }
        }
    </script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        document.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('auth_token');
            if (!token) return;

            // Fetch Companies
            try {
                const res = await fetch('http://127.0.0.1:5000/api/companies', { headers: { 'Authorization': `Bearer ${token}` } });
                const companies = await res.json();
                const container = document.getElementById('companiesContainer');
                container.innerHTML = '';

                if (companies.length === 0) container.innerHTML = '<p>No companies found.</p>';

                companies.forEach(c => {
                    const initials = c.name.substring(0, 1).toUpperCase();
                    const html = `
                        <div class="company-card">
                            <div class="company-header">
                                <div class="company-logo">${initials}</div>
                                <div class="company-info">
                                    <div class="company-name">${c.name}</div>
                                    <div class="company-rating">
                                        <i data-lucide="star" style="width: 16px; height: 16px; stroke-width: 1.5; fill: currentColor;"></i>
                                        <span>4.5</span>
                                    </div>
                                </div>
                            </div>
                            <div class="company-meta">
                                <i data-lucide="users" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                                <span>${c.description}</span>
                            </div>
                            <div class="company-footer">
                                <button class="btn btn-primary btn-sm" onclick="alert('Company details coming soon!')">Explore ‚Üí</button>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });
                lucide.createIcons();
            } catch (e) { console.error(e); }

            // Fetch Career Paths
            try {
                const res = await fetch('http://127.0.0.1:5000/api/career/paths', { headers: { 'Authorization': `Bearer ${token}` } });
                const paths = await res.json();
                const container = document.getElementById('pathsContainer');
                container.innerHTML = '';

                paths.forEach(p => {
                    const html = `
                        <div class="card card-interactive">
                            <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem;">${p.title}</h3>
                             <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">${p.description}</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 0.875rem; color: var(--text-secondary);">View details</span>
                                <button class="btn btn-primary btn-sm" onclick="alert('Path details coming soon!')">View Full Path</button>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });
            } catch (e) { console.error(e); }

            // Fetch Roadmaps
            try {
                const res = await fetch('http://127.0.0.1:5000/api/career/roadmaps', { headers: { 'Authorization': `Bearer ${token}` } });
                const roadmaps = await res.json();
                const container = document.getElementById('roadmapsContainer');
                container.innerHTML = '';

                roadmaps.forEach(r => {
                    const html = `
                        <div class="card card-interactive">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <div style="width: 48px; height: 48px; background: rgba(76, 124, 245, 0.1); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">üó∫Ô∏è</div>
                                <div style="flex: 1;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 0.25rem;">${r.title}</h3>
                                            <p style="font-size: 0.875rem; color: var(--text-secondary);">by ${r.creator}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-tertiary); margin-bottom: 1rem;">${r.saves} saves</div>
                            <button class="btn btn-primary btn-sm" style="width: 100%;" onclick="window.location.href='roadmap-detail.html?id=${r.id}'">View Roadmap</button>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });
            } catch (e) { console.error(e); }

            // Mock Experiences Fetch (using dashboard logic or similar, or just static for now as we didn't make endpoint)
            const expContainer = document.getElementById('experiencesContainer');
            expContainer.innerHTML = '<p style="padding: 20px; text-align: center; color: var(--text-secondary);">Experience sharing coming soon!</p>';

        });
    </script>
</body>

</html>